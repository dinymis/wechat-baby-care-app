<!--search.wxml-->
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- æœç´¢æ¡† -->
    <view class="search-section">
      <view class="search-input-wrapper">
        <text class="search-icon">ğŸ”</text>
        <input class="search-input" 
               placeholder="æœç´¢è‚²å„¿çŸ¥è¯†..." 
               value="{{searchKeyword}}"
               bindinput="onSearchInput"
               bindconfirm="onSearchConfirm"
               placeholder-style="color: #999;" />
        <text class="search-btn" bindtap="onSearchConfirm" wx:if="{{searchKeyword}}">æœç´¢</text>
      </view>
    </view>

    <!-- æœç´¢ç»“æœ -->
    <view class="results-section" wx:if="{{showResults}}">
      <!-- æ ‡ç­¾é¡µ -->
      <view class="tabs">
        <block wx:for="{{tabs}}" wx:key="value" wx:for-item="tab">
          <view class="tab-item {{currentTab === tab.value ? 'active' : ''}}" 
                bindtap="onTabChange" 
                data-tab="{{tab.value}}">
            <text class="tab-text">{{tab.label}}</text>
          </view>
        </block>
      </view>

      <!-- æœç´¢ç»“æœåˆ—è¡¨ -->
      <view class="results-list" wx:if="{{!loading}}">
        <block wx:for="{{searchResults}}" wx:key="id" wx:for-item="result">
          <view class="result-item" bindtap="onResultTap" data-result="{{result}}">
            <image class="result-cover" src="{{result.coverImage}}" mode="aspectFill"></image>
            <view class="result-content">
              <text class="result-title">{{result.title}}</text>
              <text class="result-desc">{{result.description}}</text>
              <view class="result-meta">
                <text class="result-author" wx:if="{{result.author}}">{{result.author}}</text>
                <text class="result-time" wx:if="{{result.publishTime}}">{{result.publishTime}}</text>
                <text class="result-stats" wx:if="{{result.readCount}}">{{result.readCount}}é˜…è¯»</text>
                <text class="result-stats" wx:if="{{result.articleCount}}">{{result.articleCount}}ç¯‡æ–‡ç« </text>
              </view>
              <view class="result-tags" wx:if="{{result.tags}}">
                <block wx:for="{{result.tags}}" wx:key="*this" wx:for-item="tag">
                  <text class="tag">{{tag}}</text>
                </block>
              </view>
            </view>
          </view>
        </block>
      </view>

      <!-- åŠ è½½çŠ¶æ€ -->
      <view class="loading" wx:if="{{loading}}">
        <text class="loading-text">æœç´¢ä¸­...</text>
      </view>

      <!-- æ— ç»“æœ -->
      <view class="no-results" wx:if="{{!loading && searchResults.length === 0}}">
        <text class="no-results-icon">ğŸ”</text>
        <text class="no-results-text">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å†…å®¹</text>
      </view>
    </view>

    <!-- æœç´¢å»ºè®® - ä¸åˆ†ç±»é¡µé¢ä¿æŒä¸€è‡´ -->
    <view class="suggestions-section" wx:if="{{!showResults}}">
      <!-- çƒ­é—¨åˆ†ç±» -->
      <view class="hot-section">
        <text class="section-title">ğŸ”¥ çƒ­é—¨åˆ†ç±»</text>
        <view class="hot-categories">
          <block wx:for="{{categories}}" wx:key="id" wx:for-item="category">
            <block wx:if="{{category.isHot}}">
              <view class="hot-category-item" 
                    bindtap="onCategoryTap" 
                    data-category="{{category}}"
                    style="background-color: {{category.color}}20;">
                <text class="category-icon">{{category.icon}}</text>
                <text class="category-name">{{category.name}}</text>
                <text class="category-count">{{category.articleCount}}ç¯‡</text>
              </view>
            </block>
          </block>
        </view>
      </view>

      <!-- å…¨éƒ¨åˆ†ç±» -->
      <view class="all-section">
        <text class="section-title">ğŸ“š å…¨éƒ¨åˆ†ç±»</text>
        <view class="categories-grid">
          <block wx:for="{{categories}}" wx:key="id" wx:for-item="category">
            <view class="category-item" 
                  bindtap="onCategoryTap" 
                  data-category="{{category}}">
              <view class="category-header">
                <text class="category-icon" style="color: {{category.color}};">{{category.icon}}</text>
                <text class="category-name">{{category.name}}</text>
              </view>
              <text class="category-desc">{{category.description}}</text>
              <view class="category-stats">
                <text class="stat-item">{{category.articleCount}}ç¯‡æ–‡ç« </text>
                <text class="stat-item">{{category.columnCount}}ä¸ªä¸“æ </text>
              </view>
            </view>
          </block>
        </view>
      </view>

      <!-- æœç´¢å†å² -->
      <view class="history-section" wx:if="{{searchHistory.length > 0}}">
        <view class="section-header">
          <text class="section-title">æœç´¢å†å²</text>
          <text class="clear-btn" bindtap="onClearHistory">æ¸…é™¤</text>
        </view>
        <view class="history-list">
          <block wx:for="{{searchHistory}}" wx:key="*this" wx:for-item="keyword">
            <view class="history-item">
              <text class="history-keyword" bindtap="onHistoryTap" data-keyword="{{keyword}}">{{keyword}}</text>
              <text class="delete-btn" bindtap="onDeleteHistory" data-keyword="{{keyword}}">Ã—</text>
            </view>
          </block>
        </view>
      </view>

      <!-- çƒ­é—¨æœç´¢ -->
      <view class="hot-search-section">
        <text class="section-title">ğŸ”¥ çƒ­é—¨æœç´¢</text>
        <view class="hot-keywords">
          <block wx:for="{{hotKeywords}}" wx:key="id" wx:for-item="keyword">
            <view class="hot-keyword-item" 
                  bindtap="onHotKeywordTap" 
                  data-keyword="{{keyword.keyword}}">
              <text class="keyword-text">{{keyword.keyword}}</text>
              <text class="keyword-count">{{keyword.count}}</text>
            </view>
          </block>
        </view>
      </view>
    </view>
  </view>
</scroll-view>
